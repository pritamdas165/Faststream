<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MovieFlix v2</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#000;
  --card:#111;
  --red:#e50914;
  --text:#fff;
  --muted:#aaa;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{background:var(--bg);color:var(--text);padding-bottom:70px}

/* HEADER */
header{
  position:sticky;top:0;z-index:10;
  padding:12px 15px;
  background:#000;
  display:flex;justify-content:space-between;align-items:center
}
.logo{color:var(--red);font-size:22px;font-weight:bold}
header input{
  width:55%;padding:6px;border-radius:4px;border:none;
  background:#222;color:#fff
}

/* HERO */
.hero{
  height:200px;
  background:linear-gradient(to top,#000,rgba(0,0,0,.3)),
  url("https://upload.wikimedia.org/wikipedia/en/4/4f/Dhoom_3_Film_Poster.jpg") center/cover;
  display:flex;align-items:flex-end;padding:15px
}

/* GRID */
.section{padding:15px}
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px
}

/* CARD */
.card{
  background:var(--card);
  border-radius:6px;
  overflow:hidden;
  position:relative
}
.card img{width:100%;height:160px;object-fit:cover}
.play{
  position:absolute;inset:0;
  display:flex;align-items:center;justify-content:center;
  font-size:40px;color:#fff;
  background:rgba(0,0,0,.5)
}
.fav{
  position:absolute;top:6px;right:6px;
  font-size:18px;color:#fff
}
.info{padding:6px}
.info strong{font-size:12px}
.info button{
  width:100%;margin-top:4px;
  padding:5px;border:none;border-radius:4px;
  font-size:11px
}
.watch{background:var(--red);color:#fff}
.download{background:#333;color:#fff}

/* SKELETON */
.skeleton{
  height:160px;
  background:linear-gradient(90deg,#222,#333,#222);
  animation:load 1.2s infinite
}
@keyframes load{
  0%{background-position:-200px}
  100%{background-position:200px}
}

/* MODAL */
#modal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.9);
  display:none;z-index:999;
  align-items:center;justify-content:center
}
#modalBox{
  background:#111;padding:15px;border-radius:6px;
  width:90%
}

/* AD BOX */
#adBox{
  display:none;
  position:fixed;inset:0;
  background:rgba(0,0,0,.95);
  z-index:1000;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center
}
#adTimer{color:var(--red);margin-top:10px}

/* ADMIN */
#admin{
  display:none;position:fixed;inset:0;
  background:#000;z-index:1000;
  padding:20px
}
#admin input,select,button{
  width:100%;padding:8px;margin-top:8px
}

/* BOTTOM NAV */
.nav{
  position:fixed;bottom:0;left:0;width:100%;
  background:#111;display:flex;
  justify-content:space-around;padding:8px 0
}
.nav button{background:none;border:none;color:#aaa}
.nav .active{color:var(--red)}
</style>
</head>

<body>

<header>
  <div class="logo">MovieFlix</div>
  <input placeholder="Search‚Ä¶" oninput="search(this.value)">
</header>

<div class="hero"><h2>Featured</h2></div>

<div class="section">
  <div class="grid" id="grid"></div>
</div>

<!-- MODAL -->
<div id="modal" onclick="closeModal()">
  <div id="modalBox" onclick="event.stopPropagation()"></div>
</div>

<!-- AD -->
<div id="adBox" style="display:none">
  <a id="adLink" href="#" target="_blank">Advertisement</a>
  <div id="adTimer"></div>
</div>

<!-- ADMIN -->
<div id="admin">
  <h2>Admin Panel</h2>
  <input id="apass" placeholder="Password">
  <button onclick="login()">Login</button>
  <div id="adminForm" style="display:none">
    <input id="title" placeholder="Title">
    <input id="poster" placeholder="Poster URL">
    <input id="watch" placeholder="Watch link">
    <input id="down" placeholder="Download link">
    <button onclick="addMovie()">Add Movie</button>
    <button onclick="closeAdmin()">Close</button>
  </div>
</div>

<div class="nav">
  <button class="active">Home</button>
  <button onclick="openAdmin()">Admin</button>
</div>

<script>
/* ===== CONFIG ===== */
const AD_POP="https://example.com";
const AD_DELAY=5;

/* ===== STORAGE ===== */
let movies=JSON.parse(localStorage.getItem("movies")||"[]");
let favs=JSON.parse(localStorage.getItem("favs")||"[]");
let adminPass=localStorage.getItem("ap")||"admin123";

/* ===== INIT ===== */
if(!movies.length){
 movies=[
  {
   title:"Dhoom 3",
   poster:"https://upload.wikimedia.org/wikipedia/en/4/4f/Dhoom_3_Film_Poster.jpg",
   watch:"https://youtu.be/B7prWpweShU",
   down:"https://example.com"
  }
 ];
 localStorage.setItem("movies",JSON.stringify(movies));
}
render(movies);

/* ===== RENDER ===== */
function render(list){
 let g=document.getElementById("grid");
 g.innerHTML="";
 list.forEach((m,i)=>{
  g.innerHTML+=`
  <div class="card">
   <img src="${m.poster}">
   <div class="play" onclick="details(${i})">‚ñ∂</div>
   <div class="fav" onclick="toggleFav(${i})">
    ${favs.includes(i)?"‚ù§Ô∏è":"ü§ç"}
   </div>
   <div class="info">
    <strong>${m.title}</strong>
    <button class="watch" onclick="ads('${m.watch}')">Watch</button>
    <button class="download" onclick="ads('${m.down}')">Download</button>
   </div>
  </div>`;
 });
}

/* ===== SEARCH ===== */
function search(v){
 render(movies.filter(m=>m.title.toLowerCase().includes(v.toLowerCase())));
}

/* ===== MODAL ===== */
function details(i){
 modal.style.display="flex";
 modalBox.innerHTML=`
  <h3>${movies[i].title}</h3>
  <img src="${movies[i].poster}" style="width:100%;margin-top:10px">
 `;
}
function closeModal(){modal.style.display="none"}

/* ===== FAV ===== */
function toggleFav(i){
 if(favs.includes(i))favs=favs.filter(x=>x!=i);
 else favs.push(i);
 localStorage.setItem("favs",JSON.stringify(favs));
 render(movies);
}

/* ===== ADS ===== */
function runAds(finalURL){
  // popup ad (new tab)
  window.open(POP_AD_URL, "_blank");

  // show ad box
  const adBox = document.getElementById("adBox");
  const adLink = document.getElementById("adLink");
  const adTimer = document.getElementById("adTimer");

  adBox.style.display = "flex";
  adLink.href = DIRECT_AD_URL;

  let t = 5;
  adTimer.innerText = "Wait " + t + " sec";

  let timer = setInterval(()=>{
    t--;
    adTimer.innerText = "Wait " + t + " sec";

    if(t <= 0){
      clearInterval(timer);
      adBox.style.display = "none";
      window.location.href = finalURL;
    }
  },1000);
}


/* ===== ADMIN ===== */
function openAdmin(){admin.style.display="block"}
function closeAdmin(){admin.style.display="none"}
function login(){
 if(apass.value===adminPass){
  adminForm.style.display="block";
 }else alert("Wrong password");
}
function addMovie(){
 movies.push({
  title:title.value,
  poster:poster.value,
  watch:watch.value,
  down:down.value
 });
 localStorage.setItem("movies",JSON.stringify(movies));
 render(movies);
 alert("Movie Added");
}
</script>
</body>
</html>
